@model List<Projetos>
@using Microsoft.AspNetCore.Http;
@using Newtonsoft.Json;
@using MySql.Data.MySqlClient;
<!doctype html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="/CSS/index.css">
    <link rel="stylesheet" href="/JS/index.js">
    <script src="https://kit.fontawesome.com/9ab573c9fb.js" crossorigin="anonymous"></script>
    <title>Página Inicial</title>
</head>

<body>

    <header>

        <nav class="navbar navbar-expand-lg ">
            <div class="container">
                <div class="">
                    <a href="/HOME/inicio.html"><img class="logo" src="/IMG/logo1.JPG"></a>
                </div>


                <form class=" pesquisa d-flex">
                    <input class="form-control me-2" type="search" placeholder="Pesquisar" aria-label="Search">
                    <button class="btn btn-outline-primary" type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
                </form>


                <div class="div-links">
                    <div class="link">
                        <a href="#">Nome do Usuário</a>
                    </div>
                    <div class="link">
                        <a href="#"><i id="icones" class="fa-solid fa-arrow-right-to-bracket"></i></a>
                    </div>
                </div>
            </div>

        </nav>
    </header>
    @if (Model != null) {


        foreach (Projetos p in Model) {
            byte[] img_user = null;
            string nome_user = "";
            MySqlConnection con = new MySqlConnection("Server=ESN509VMYSQL;Database=sgu;User id=aluno;Password=Senai1234");
            con.Open();
            MySqlCommand comando = new MySqlCommand("select img_user , nome_user from usuario where doc_user = @doc", con);
            comando.Parameters.AddWithValue("@doc", p.Doc_user);
            MySqlDataReader leitor = comando.ExecuteReader();
            while (leitor.Read()) {
                img_user = (byte[])leitor["img_user"];
                nome_user = leitor["nome_user"].ToString();
            }
            string formatoImg_user = "data:image/jpeg;base64," + Convert.ToBase64String(img_user);
            int i = 0;
            con.Close();

        <div class="publicacao container">

            <div class="identificacao conteiner row ">
                <div class="foto-perfil col-3">
                    <img src="@formatoImg_user">
                </div>
                <div class="col">
                    <h4>@nome_user</h4>
                    <h6>
                      @p.Desc
                    </h6>
                </div>
            </div>
            @foreach (byte[] img in p.Galeria) {

                string formatoImg_proj = "data:image/jpeg;base64," + Convert.ToBase64String(p.Galeria[i]);

            <div class="imagens container">
                <img src="@formatoImg_proj" />
            </div>
                i++;
            }
            <div class="comentarios">
                <button id="like">
                    <div class="label">
                        <i class="fa-regular fa-heart"></i>
                        Curtir
                    </div>

                    <div class="number" id="number">0</div>
                </button>
            </div>
        </div>
        }
    }


        <div class="add">
            <a href=""><i id="icone" class=" fa-solid fa-square-plus"></i></a>
        </div>
        

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
                crossorigin="anonymous"></script>


    </body>

</html>